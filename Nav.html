<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background: transparent;
            margin: 0;
            padding: 1.5rem;
            color: white;
            overflow-x: hidden;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* Tarjeta Usuario Compacta Blanca */
        #user-profile-card {
            background: white;
            padding: 0.75rem;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        #user-avatar { width: 40px; height: 40px; border-radius: 9999px; object-fit: cover; }
        #user-info-text { display: flex; flex-direction: column; text-align: left; }
        #user-name { color: #0f172a; font-size: 11px; line-height: 1; font-weight: 900; }
        #user-puesto { color: #64748b; font-size: 8px; font-weight: 700; }

        /* Botones del Lanzador con Color Integrado */
        .app-item-card {
            transition: all 0.2s ease;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-radius: 1rem;
            width: 100%;
            text-align: left;
            cursor: pointer;
            margin-bottom: 0.5rem;
        }

        .app-item-card:hover {
            filter: brightness(1.2);
            transform: translateX(5px);
        }

        /* Colores específicos por botón */
        .btn-dashboard { background-color: #334155; }
        .btn-forms { background-color: #000000; border-color: rgba(255,255,255,0.2); }
        .btn-regas { background-color: #4a044e; }
        .btn-regsin { background-color: #450a0a; }
        .btn-miespacio { background-color: #581c87; }
        .btn-marbetes { background-color: #064e3b; }
        .btn-users { background-color: #0369a1; }
        
        /* Nuevas Aplicaciones */
        .btn-cctv { background-color: #0f172a; }
        .btn-legal { background-color: #78350f; }
        .btn-ingresos { background-color: #164e63; }
        .btn-externos { background-color: #7c2d12; }

        h3 {
            text-transform: uppercase;
            font-size: 10px;
            font-weight: 900;
            color: #64748b;
            letter-spacing: 0.2em;
            margin-bottom: 1rem;
            padding-left: 0.5rem;
        }
    </style>
</head>
<body class="no-scrollbar">

    <!-- Tarjeta de Usuario -->
    <div id="user-profile-card">
        <img id="user-avatar" src="M/User.png" onerror="this.src='https://placehold.co/100x100?text=User'">
        <div id="user-info-text">
            <span id="user-name" class="uppercase">Cargando...</span>
            <span id="user-puesto" class="uppercase tracking-wider">Identificando...</span>
        </div>
        <button onclick="logout()" class="ml-auto text-red-500 hover:scale-110 transition-transform">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
        </button>
    </div>

    <h3>Aplicaciones CIC</h3>
    
    <div id="apps-grid">
        <div onclick="launch('dashboard', 'Escritorio', '', '#000000')" class="app-item-card btn-dashboard">
            <img src="M/Logo.png" class="h-6 w-6 object-contain grayscale invert">
            <div><span class="block text-[11px] font-black text-white uppercase">Escritorio</span><span class="block text-[8px] text-slate-300 uppercase font-bold">Principal</span></div>
        </div>

        <div onclick="launch('forms', 'Centro de Formularios', 'Apps/Formularios.html', '#000000')" class="app-item-card btn-forms">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
            <div><span class="block text-[11px] font-black text-white uppercase">Centro de Formularios</span><span class="block text-[8px] text-slate-400 uppercase font-bold">Documentos Oficiales</span></div>
        </div>

        <div onclick="launch('regas', 'Registro de Asistencia', 'Apps/RegAs.html', '#4a044e')" class="app-item-card btn-regas">
            <img src="M/Logo-App/RegAs.png" class="h-6 w-6 object-contain">
            <div><span class="block text-[11px] font-black text-white uppercase">Registro de Asistencia</span><span class="block text-[8px] text-fuchsia-200 uppercase font-bold">Control de Personal</span></div>
        </div>

        <div onclick="launch('regsin', 'Registro de Siniestros', 'Apps/RegSin.html', '#450a0a')" class="app-item-card btn-regsin">
            <img src="M/Logo-App/RegSin.png" class="h-6 w-6 object-contain">
            <div><span class="block text-[11px] font-black text-white uppercase">Registro de Siniestros</span><span class="block text-[8px] text-red-200 uppercase font-bold">Reporte de Eventos</span></div>
        </div>

        <!-- Nuevas Aplicaciones Sugeridas -->
        <div onclick="launch('cctv', 'Sistema CCTV', 'Apps/CCTV.html', '#0f172a')" class="app-item-card btn-cctv">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
            <div><span class="block text-[11px] font-black text-white uppercase">Sistema CCTV</span><span class="block text-[8px] text-slate-300 uppercase font-bold">Monitoreo en Tiempo Real</span></div>
        </div>

        <div onclick="launch('legal', 'Notificaciones Legales', 'Apps/Legal.html', '#78350f')" class="app-item-card btn-legal">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>
            <div><span class="block text-[11px] font-black text-white uppercase">Notificaciones Legales</span><span class="block text-[8px] text-amber-200 uppercase font-bold">Gestión Jurídica</span></div>
        </div>

        <div onclick="launch('ingresos', 'Ingresos de Personal', 'Apps/Ingresos.html', '#164e63')" class="app-item-card btn-ingresos">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
            <div><span class="block text-[11px] font-black text-white uppercase">Ingresos de Personal</span><span class="block text-[8px] text-cyan-200 uppercase font-bold">Control de Accesos</span></div>
        </div>

        <div onclick="launch('externos', 'Personal Externo', 'Apps/Externos.html', '#7c2d12')" class="app-item-card btn-externos">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
            <div><span class="block text-[11px] font-black text-white uppercase">Personal Externo</span><span class="block text-[8px] text-orange-200 uppercase font-bold">Proveedores y Visitas</span></div>
        </div>

        <div onclick="launch('users', 'Gestión de Usuarios', 'Apps/Admin_Users.html', '#0369a1')" class="app-item-card btn-users">
            <img src="M/Logo-App/Users.png" class="h-6 w-6 object-contain">
            <div><span class="block text-[11px] font-black text-white uppercase">Gestión de Usuarios</span><span class="block text-[8px] text-sky-200 uppercase font-bold">Administración Central</span></div>
        </div>

        <div onclick="launch('miespacio', 'Mi Espacio', 'Apps/MiEspacio.html', '#581c87')" class="app-item-card btn-miespacio">
            <img src="M/Logo-App/Space.png" class="h-6 w-6 object-contain">
            <div><span class="block text-[11px] font-black text-white uppercase">Mi Espacio</span><span class="block text-[8px] text-purple-200 uppercase font-bold">Perfil del Colaborador</span></div>
        </div>

        <div onclick="launch('marbetes', 'Gestión de Marbetes', 'Apps/Marbetes.html', '#064e3b')" class="app-item-card btn-marbetes">
            <img src="M/Logo-App/Marbetes.png" class="h-6 w-6 object-contain" onerror="this.src='M/Apps.png'">
            <div><span class="block text-[11px] font-black text-white uppercase">Gestión de Marbetes</span><span class="block text-[8px] text-green-200 uppercase font-bold">Control Vehicular</span></div>
        </div>
    </div>

    <script>
        // Función para abrir aplicaciones comunicándose con el padre
        function launch(id, title, url, color) {
            window.parent.openApp(id, title, url, color);
        }

        function logout() {
            window.parent.handleLogout();
        }

        // Escuchar datos del usuario desde Administracion.html
        window.addEventListener('message', (event) => {
            if (event.data.type === 'USER_DATA_SYNC') {
                const user = event.data.user;
                document.getElementById('user-name').textContent = user.nombre || 'Personal CIC';
                document.getElementById('user-puesto').textContent = user.puesto || 'Operativo';
                if (user.foto) document.getElementById('user-avatar').src = user.foto;
            }
        });

        // Solicitar contexto al cargar
        window.onload = () => {
            window.parent.postMessage({ type: 'REQUEST_USER_CONTEXT' }, '*');
        };
    </script>
</body>
</html>