<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shell de Mantenimiento - CIC6</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-green-dark: #064e3b;
            --brand-green-mid: #059669;
            --brand-green-light: #10b981;
        }
        /* Ajuste crítico: El shell debe llenar el contenedor padre sin forzar vh */
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #ffffff; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            margin: 0; 
        }
        
        #Shell_Root {
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            width: 100%;
        }

        /* Navegación Fija Superior */
        .module-nav { 
            background: #f8fafc; 
            border-bottom: 1px solid #e2e8f0; 
            padding: 0.75rem; 
            flex-shrink: 0; 
            display: flex; 
            gap: 0.5rem; 
            overflow-x: auto; 
            scrollbar-width: none; 
            z-index: 50; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .module-nav::-webkit-scrollbar { display: none; }
        
        .nav-tab {
            white-space: nowrap;
            padding: 0.5rem 1.25rem;
            border-radius: 0.75rem;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            color: #64748b;
            border: 1px solid #e2e8f0;
            background: white;
            transition: all 0.2s;
            cursor: pointer;
        }
        .nav-tab:hover { border-color: var(--brand-green-mid); color: var(--brand-green-dark); }
        .nav-tab.active { 
            background: linear-gradient(135deg, var(--brand-green-dark), var(--brand-green-mid)); 
            color: white !important; 
            border-color: var(--brand-green-dark); 
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.2); 
        }
        
        /* El contenedor de módulos con margen de 50px solicitado */
        #Module_Container { 
            flex: 1; 
            width: 100%; 
            margin-top: 50px;
            overflow: hidden; 
            background: #fff; 
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .fade-in { animation: fadeIn 0.3s ease-out forwards; width: 100%; height: 100%; display: flex; flex-direction: column; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            text-align: center;
            padding: 2rem;
            background-color: #f8fafc;
        }
    </style>
</head>
<body>

    <div id="Shell_Root">
        <!-- Navegación de Módulos Especializados (Fijo Arriba) -->
        <nav class="module-nav">
            <button onclick="LoadModule('Format_Nombre')" id="tab-Format_Nombre" class="nav-tab" title="Limpia nombres y espacios extra.">Formato Nombres</button>
            <button onclick="LoadModule('Format_Telefono')" id="tab-Format_Telefono" class="nav-tab" title="Normaliza teléfonos a 10 dígitos.">Formato Teléfonos</button>
            <button onclick="LoadModule('Format_Correo')" id="tab-Format_Correo" class="nav-tab" title="Valida estructura de correos.">Formato Correos</button>
            <button onclick="LoadModule('Logic_Status')" id="tab-Logic_Status" class="nav-tab" title="Valida congruencia entre Folio y Estatus.">Lógica Estatus</button>
            <button onclick="LoadModule('Aged_Requests')" id="tab-Aged_Requests" class="nav-tab" title="Solicitudes con rezago temporal.">Antiguos</button>
            <button onclick="LoadModule('Duplicates')" id="tab-Duplicates" class="nav-tab" title="Elimina registros redundantes.">Duplicados</button>
        </nav>

        <!-- Contenedor Dinámico -->
        <main id="Module_Container">
            <!-- Pantalla de Bienvenida por defecto -->
        </main>
    </div>

    <script>
        function ShowWelcome() {
            const container = document.getElementById('Module_Container');
            container.innerHTML = `
                <div class="welcome-screen fade-in">
                    <div class="w-24 h-24 bg-emerald-50 rounded-full flex items-center justify-center mb-6 border border-emerald-100 shadow-sm">
                        <svg class="text-emerald-500" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                    </div>
                    <h2 class="text-xl font-black text-emerald-900 uppercase tracking-tighter">Centro de Saneamiento CIC6</h2>
                    <p class="text-slate-500 text-xs font-bold uppercase tracking-widest mt-2 max-w-sm leading-relaxed">
                        Seleccione una herramienta del menú superior para comenzar el diagnóstico y reparación de la base de datos.
                    </p>
                </div>
            `;
        }

        function LoadModule(moduleName) {
            const container = document.getElementById('Module_Container');
            const tabs = document.querySelectorAll('.nav-tab');
            
            tabs.forEach(t => t.classList.remove('active'));
            const activeBtn = document.getElementById(`tab-${moduleName}`);
            if (activeBtn) activeBtn.classList.add('active');

            container.innerHTML = `
                <div class="flex flex-col items-center justify-center h-full text-slate-300">
                    <div class="w-8 h-8 border-4 border-slate-100 border-t-emerald-500 rounded-full animate-spin mb-4"></div>
                    <p class="text-[10px] font-black uppercase tracking-widest text-center px-6">Sincronizando Módulo...</p>
                </div>
            `;

            const path = `Componentes/Marbetes/Fix/${moduleName}.html`;
            
            fetch(path)
                .then(res => { if(!res.ok) throw new Error(); return res.text(); })
                .then(html => {
                    container.innerHTML = `<div class="fade-in h-full">${html}</div>`;
                    
                    const scripts = container.querySelectorAll('script');
                    scripts.forEach(oldScript => {
                        const newScript = document.createElement('script');
                        Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
                        newScript.appendChild(document.createTextNode(oldScript.innerHTML));
                        oldScript.parentNode.replaceChild(newScript, oldScript);
                    });
                })
                .catch(() => {
                    container.innerHTML = `
                        <div class="p-20 text-center">
                            <p class="text-xs font-black text-rose-500 uppercase tracking-widest">Error: Módulo [${moduleName}] no disponible</p>
                            <p class="text-[9px] text-slate-400 mt-2">Ruta intentada: ${path}</p>
                        </div>
                    `;
                });
        }

        document.addEventListener('DOMContentLoaded', ShowWelcome);
    </script>
</body>
</html>